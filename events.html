<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Gallery | MET'S IEDC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { background-color: #050505; color: #ffffff; font-family: 'Inter', sans-serif; }
        .glass-nav { background: rgba(5, 5, 5, 0.8); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
        .photo-card { break-inside: avoid; margin-bottom: 24px; position: relative; overflow: hidden; border-radius: 16px; cursor: zoom-in; }
        .photo-card img { width: 100%; display: block; transition: transform 0.5s ease; }
        .photo-card:hover img { transform: scale(1.05); }
        .photo-overlay { position: absolute; bottom: 0; left: 0; width: 100%; background: linear-gradient(to top, rgba(0,0,0,0.8), transparent); padding: 20px; opacity: 0; transition: opacity 0.3s; }
        .photo-card:hover .photo-overlay { opacity: 1; }
        .lightbox { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 100; display: none; align-items: center; justify-content: center; }
        .masonry { column-count: 1; gap: 24px; }
        @media (min-width: 640px) { .masonry { column-count: 2; } }
        @media (min-width: 1024px) { .masonry { column-count: 3; } }
    </style>
</head>
<body>

    <nav class="glass-nav fixed top-0 w-full z-50">
        <div class="max-w-7xl mx-auto px-4 h-20 flex items-center justify-between">
            <div class="flex items-center gap-3"><img src="assets/images/logos/MSEM.jpg" class="h-10 w-10 rounded-full"><span class="text-xl font-bold">MET'S <span class="text-purple-500">IEDC</span></span></div>
            <a href="index.html" class="text-gray-300 hover:text-white text-sm font-bold">Home</a>
        </div>
    </nav>

    <div class="pt-32 pb-12 text-center px-4">
        <h1 class="text-5xl font-bold mb-4">Event Gallery</h1>
        <p class="text-gray-400">Capturing moments of innovation and collaboration.</p>
    </div>

    <div class="max-w-7xl mx-auto px-4 pb-20">
        <div id="loader" class="text-center py-20 text-gray-500">Loading photos...</div>
        <div id="galleryGrid" class="masonry hidden"></div>
    </div>

    <div id="lightbox" class="lightbox" onclick="this.style.display='none'">
        <img id="lightboxImg" class="max-h-[90vh] max-w-[90vw] object-contain rounded-lg">
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, getDocs, orderBy, query } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // --- PASTE FIREBASE CONFIG HERE ---
        const firebaseConfig = {
            apiKey: "AIzaSyAIn9hB7Hx4Nwwk5Ar9bE3tFuo40VkBcc8",
            authDomain: "metsiedc-3010e.firebaseapp.com",
            databaseURL: "https://metsiedc-3010e-default-rtdb.firebaseio.com",
            projectId: "metsiedc-3010e",
            storageBucket: "metsiedc-3010e.firebasestorage.app",
            messagingSenderId: "954403413150",
            appId: "1:954403413150:web:2523a3377f15a3d6002f8f",
            measurementId: "G-6E7EK0D7JG"
        };
        // ----------------------------------

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function fetchGallery() {
            try {
                const q = query(collection(db, "gallery"), orderBy("timestamp", "desc"));
                const snap = await getDocs(q);
                const grid = document.getElementById('galleryGrid');
                
                if(snap.empty) { document.getElementById('loader').innerText = "No photos yet."; return; }
                
                grid.innerHTML = "";
                snap.forEach(doc => {
                    const data = doc.data();
                    const item = document.createElement('div');
                    item.className = "photo-card";
                    item.innerHTML = `
                        <img src="${data.imageUrl}" loading="lazy">
                        <div class="photo-overlay">
                            <h3 class="text-white font-bold">${data.title}</h3>
                            <p class="text-xs text-gray-300">${data.date || ''}</p>
                        </div>
                    `;
                    item.onclick = () => {
                        document.getElementById('lightboxImg').src = data.imageUrl;
                        document.getElementById('lightbox').style.display = "flex";
                    };
                    grid.appendChild(item);
                });
                
                document.getElementById('loader').classList.add('hidden');
                grid.classList.remove('hidden');

            } catch(e) { console.error(e); }
        }
        fetchGallery();
    </script>
</body>
</html>
