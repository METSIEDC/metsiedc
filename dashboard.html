<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | MET'S IEDC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #050505;
            color: #ffffff;
            overflow-x: hidden;
        }

        /* Glassmorphism Classes */
        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .glass-sidebar {
            background: rgba(5, 5, 5, 0.8);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.05);
        }

        .glass-header {
            background: rgba(5, 5, 5, 0.7);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Form Inputs */
        .glass-input {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.3s ease;
        }
        .glass-input:focus {
            background: rgba(255, 255, 255, 0.08);
            border-color: #6366f1;
            outline: none;
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
        }
        .glass-input::placeholder { color: rgba(255, 255, 255, 0.3); }
        
        select.glass-input option {
            background-color: #1a1a1a;
            color: white;
        }

        /* Sidebar Links */
        .sidebar-link {
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }
        .sidebar-link:hover {
            background: rgba(255, 255, 255, 0.05);
            color: white;
        }
        .sidebar-link.active {
            background: rgba(99, 102, 241, 0.1);
            color: #818cf8;
            border-left-color: #818cf8;
        }

        /* Background Blobs */
        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.4;
            animation: blob-bounce 10s infinite ease;
        }
        .blob-1 { top: 0%; left: 0%; width: 600px; height: 600px; background: #4f46e5; }
        .blob-2 { bottom: 0%; right: 0%; width: 500px; height: 500px; background: #9333ea; }

        @keyframes blob-bounce {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(20px, -20px) scale(1.1); }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #050505; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }

        /* Profile Info Item */
        .profile-item {
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
            padding: 12px 0;
        }
        .profile-item:last-child { border-bottom: none; }
    </style>
</head>
<body class="font-sans antialiased relative selection:bg-indigo-500 selection:text-white flex h-screen overflow-hidden">

    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
    </div>

    <aside class="glass-sidebar w-64 flex-shrink-0 hidden md:flex flex-col h-full z-20">
        <div class="p-6 flex items-center gap-3">
            <img src="assets/images/logos/MSEM.jpg" alt="Logo" class="w-10 h-10 rounded-full border border-white/20">
            <span class="text-xl font-bold text-white">MET'S IEDC</span>
        </div>

        <nav class="flex-grow px-4 py-4 space-y-2 overflow-y-auto">
            <button onclick="showTab('dashboardOverview')" class="sidebar-link active w-full flex items-center gap-3 px-4 py-3 rounded-r-lg text-gray-400 text-sm font-medium">
                <i data-lucide="layout-dashboard" class="w-5 h-5"></i> Dashboard
            </button>
            <button onclick="showTab('profile')" class="sidebar-link w-full flex items-center gap-3 px-4 py-3 rounded-r-lg text-gray-400 text-sm font-medium">
                <i data-lucide="user" class="w-5 h-5"></i> My Profile
            </button>
            <a href="https://iedc.startupmission.in/report/" target="_blank" class="sidebar-link w-full flex items-center gap-3 px-4 py-3 rounded-r-lg text-gray-400 text-sm font-medium">
                <i data-lucide="file-text" class="w-5 h-5"></i> Submit Report
            </a>
            <button onclick="showTab('submitProject')" class="sidebar-link w-full flex items-center gap-3 px-4 py-3 rounded-r-lg text-gray-400 text-sm font-medium">
                <i data-lucide="folder-plus" class="w-5 h-5"></i> Submit Project
            </button>
            <button onclick="showTab('submitIdea')" class="sidebar-link w-full flex items-center gap-3 px-4 py-3 rounded-r-lg text-gray-400 text-sm font-medium">
                <i data-lucide="lightbulb" class="w-5 h-5"></i> Submit Idea
            </button>
            <button onclick="showTab('submitEvent')" class="sidebar-link w-full flex items-center gap-3 px-4 py-3 rounded-r-lg text-gray-400 text-sm font-medium">
                <i data-lucide="calendar-plus" class="w-5 h-5"></i> Propose Event
            </button>
        </nav>

        <div class="p-4 border-t border-white/5">
            <button id="logoutBtnSidebar" class="w-full flex items-center justify-center gap-2 bg-red-500/10 hover:bg-red-500/20 text-red-400 hover:text-red-300 py-2.5 rounded-lg transition-colors text-sm font-medium border border-red-500/20">
                <i data-lucide="log-out" class="w-4 h-4"></i> Logout
            </button>
        </div>
    </aside>

    <div class="flex-grow flex flex-col h-full overflow-hidden relative z-10">
        
        <header class="glass-header h-20 flex items-center justify-between px-6 md:px-10 shrink-0">
            <div class="flex items-center gap-4">
                <button id="mobile-menu-toggle" class="md:hidden text-white p-2">
                    <i data-lucide="menu" class="w-6 h-6"></i>
                </button>
                <div>
                    <h1 class="text-xl font-bold text-white">Dashboard</h1>
                    <p class="text-xs text-gray-400 hidden sm:block">Welcome back to your workspace</p>
                </div>
            </div>
            
            <div class="flex items-center gap-6">
                <div class="hidden sm:flex gap-4 text-gray-400">
                    <button class="hover:text-white transition-colors"><i data-lucide="bell" class="w-5 h-5"></i></button>
                    <button class="hover:text-white transition-colors"><i data-lucide="settings" class="w-5 h-5"></i></button>
                </div>
                <div class="flex items-center gap-3 pl-6 border-l border-white/10">
                    <div class="text-right hidden sm:block">
                        <p class="text-sm font-medium text-white" id="userEmailHeader">user@example.com</p>
                        <p class="text-xs text-gray-500">Student</p>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-gradient-to-tr from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold text-lg shadow-lg" id="userAvatarHeader">
                        U
                    </div>
                </div>
            </div>
        </header>

        <main class="flex-grow overflow-y-auto p-6 md:p-10 scroll-smooth">
            
            <div id="dashboardOverviewSection" class="tab-content space-y-8 max-w-7xl mx-auto">
                <div class="glass-card rounded-3xl p-8 md:p-10 relative overflow-hidden">
                    <div class="relative z-10">
                        <h2 class="text-3xl font-bold text-white mb-2">Hello, <span id="displayNameBanner" class="text-indigo-400">User</span>! ðŸ‘‹</h2>
                        <p class="text-gray-400 max-w-xl">Ready to turn your innovative ideas into reality? Start by submitting a new project or checking your progress.</p>
                    </div>
                    <div class="absolute right-0 bottom-0 opacity-20 pointer-events-none">
                        <i data-lucide="rocket" class="w-48 h-48 text-indigo-500 transform translate-x-10 translate-y-10"></i>
                    </div>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="glass-card p-6 rounded-2xl flex flex-col items-center justify-center text-center hover:bg-white/5 transition-colors cursor-pointer group">
                        <div class="w-12 h-12 rounded-full bg-yellow-500/20 text-yellow-400 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                            <i data-lucide="trending-up" class="w-6 h-6"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-white mb-1">0%</h3>
                        <p class="text-xs text-gray-500 uppercase tracking-wider">Completion</p>
                    </div>
                    <div class="glass-card p-6 rounded-2xl flex flex-col items-center justify-center text-center hover:bg-white/5 transition-colors cursor-pointer group">
                        <div class="w-12 h-12 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                            <i data-lucide="check-circle" class="w-6 h-6"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-white mb-1">0</h3>
                        <p class="text-xs text-gray-500 uppercase tracking-wider">Tasks Done</p>
                    </div>
                    <div class="glass-card p-6 rounded-2xl flex flex-col items-center justify-center text-center hover:bg-white/5 transition-colors cursor-pointer group">
                        <div class="w-12 h-12 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                            <i data-lucide="lightbulb" class="w-6 h-6"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-white mb-1">0</h3>
                        <p class="text-xs text-gray-500 uppercase tracking-wider">Ideas</p>
                    </div>
                    <div class="glass-card p-6 rounded-2xl flex flex-col items-center justify-center text-center hover:bg-white/5 transition-colors cursor-pointer group">
                        <div class="w-12 h-12 rounded-full bg-emerald-500/20 text-emerald-400 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                            <i data-lucide="eye" class="w-6 h-6"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-white mb-1">0</h3>
                        <p class="text-xs text-gray-500 uppercase tracking-wider">Views</p>
                    </div>
                </div>

                <div>
                    <h3 class="text-xl font-bold text-white mb-4">Recent Activity</h3>
                    <div class="glass-card rounded-2xl p-8 text-center border-dashed border-2 border-white/10">
                        <div class="w-16 h-16 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-500">
                            <i data-lucide="inbox" class="w-8 h-8"></i>
                        </div>
                        <p class="text-gray-400">No recent submissions or activity found.</p>
                        <button onclick="showTab('submitIdea')" class="mt-4 text-indigo-400 text-sm hover:text-indigo-300 font-medium">Submit your first idea &rarr;</button>
                    </div>
                </div>
            </div>

            <div id="profileSection" class="tab-content hidden max-w-5xl mx-auto">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="glass-card rounded-3xl p-8 text-center h-fit">
                        <div class="w-24 h-24 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 mx-auto flex items-center justify-center text-3xl font-bold text-white mb-6 shadow-lg shadow-indigo-500/30">
                            <i data-lucide="user"></i>
                        </div>
                        <h2 class="text-xl font-bold text-white mb-1" id="displayNameOutput">Not set</h2>
                        <p class="text-sm text-gray-400 mb-6" id="bioOutput">No bio available</p>
                        
                        <div class="space-y-4 text-left">
                            <div class="profile-item flex items-center gap-3 text-sm">
                                <i data-lucide="mail" class="w-4 h-4 text-indigo-400"></i>
                                <span class="text-gray-300 truncate" id="emailOutput">user@example.com</span>
                            </div>
                            <div class="profile-item flex items-center gap-3 text-sm">
                                <i data-lucide="phone" class="w-4 h-4 text-indigo-400"></i>
                                <span class="text-gray-300" id="contactNumberOutput">Not set</span>
                            </div>
                            <div class="profile-item flex items-center gap-3 text-sm">
                                <i data-lucide="map-pin" class="w-4 h-4 text-indigo-400"></i>
                                <span class="text-gray-300" id="locationOutput">Not set</span>
                            </div>
                        </div>
                    </div>

                    <div class="glass-card rounded-3xl p-8 lg:col-span-2">
                        <h3 class="text-xl font-bold text-white mb-6 flex items-center gap-2">
                            <i data-lucide="edit-3" class="w-5 h-5 text-indigo-400"></i> Edit Profile
                        </h3>
                        <div id="profileStatusMessage" class="hidden mb-4 p-3 rounded-lg text-sm"></div>
                        
                        <form id="profileForm" class="space-y-5">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Full Name</label>
                                    <input type="text" id="profileName" class="glass-input w-full rounded-xl py-2.5 px-4 text-sm" placeholder="John Doe">
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Contact Number</label>
                                    <input type="tel" id="profileContact" class="glass-input w-full rounded-xl py-2.5 px-4 text-sm" placeholder="+91 9876543210">
                                </div>
                            </div>

                            <div>
                                <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Bio</label>
                                <textarea id="profileBio" rows="3" class="glass-input w-full rounded-xl py-2.5 px-4 text-sm" placeholder="Tell us a bit about yourself..."></textarea>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">City</label>
                                    <input type="text" id="profileCity" class="glass-input w-full rounded-xl py-2.5 px-4 text-sm">
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">State</label>
                                    <input type="text" id="profileState" class="glass-input w-full rounded-xl py-2.5 px-4 text-sm">
                                </div>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">LinkedIn URL</label>
                                    <input type="url" id="profileLinkedIn" class="glass-input w-full rounded-xl py-2.5 px-4 text-sm" placeholder="https://linkedin.com/in/...">
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Instagram URL</label>
                                    <input type="url" id="profileInstagram" class="glass-input w-full rounded-xl py-2.5 px-4 text-sm" placeholder="https://instagram.com/...">
                                </div>
                            </div>

                            <div class="pt-4">
                                <button type="submit" class="bg-indigo-600 hover:bg-indigo-500 text-white font-semibold py-3 px-6 rounded-xl transition-all shadow-lg shadow-indigo-500/30 flex items-center gap-2">
                                    <i data-lucide="save" class="w-4 h-4"></i> Save Changes
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div id="submitProjectSection" class="tab-content hidden max-w-3xl mx-auto">
                <div class="glass-card rounded-3xl p-8 md:p-10">
                    <h2 class="text-2xl font-bold text-white mb-2">Submit Project</h2>
                    <p class="text-gray-400 text-sm mb-8">Share your innovative project details with us.</p>
                    <div id="projectStatusMessage" class="hidden mb-4 p-3 rounded-lg text-sm bg-green-500/10 border border-green-500/20 text-green-400"></div>

                    <form id="projectForm" class="space-y-6">
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Project Name</label>
                            <input type="text" id="projectName" class="glass-input w-full rounded-xl py-3 px-4 text-sm">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Description</label>
                            <textarea id="projectDescription" rows="5" class="glass-input w-full rounded-xl py-3 px-4 text-sm"></textarea>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Technology Stack</label>
                            <input type="text" id="projectStack" class="glass-input w-full rounded-xl py-3 px-4 text-sm" placeholder="e.g. React, Node.js, Python">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Project Link (GitHub/Drive)</label>
                            <input type="url" id="projectLink" class="glass-input w-full rounded-xl py-3 px-4 text-sm">
                        </div>
                        <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-semibold py-3.5 rounded-xl transition-all shadow-lg shadow-indigo-500/30">
                            Submit Project
                        </button>
                    </form>
                </div>
            </div>

            <div id="submitIdeaSection" class="tab-content hidden max-w-3xl mx-auto">
                <div class="glass-card rounded-3xl p-8 md:p-10">
                    <h2 class="text-2xl font-bold text-white mb-2">Submit Idea</h2>
                    <p class="text-gray-400 text-sm mb-8">Got a spark? Pitch your idea for evaluation.</p>
                    <div id="ideaStatusMessage" class="hidden mb-4 p-3 rounded-lg text-sm bg-green-500/10 border border-green-500/20 text-green-400"></div>

                    <form id="ideaForm" class="space-y-6">
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Idea Title</label>
                            <input type="text" id="ideaName" class="glass-input w-full rounded-xl py-3 px-4 text-sm">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Problem Statement</label>
                            <textarea id="ideaProblem" rows="3" class="glass-input w-full rounded-xl py-3 px-4 text-sm"></textarea>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Proposed Solution</label>
                            <textarea id="ideaSolution" rows="5" class="glass-input w-full rounded-xl py-3 px-4 text-sm"></textarea>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Category</label>
                            <select id="ideaCategory" class="glass-input w-full rounded-xl py-3 px-4 text-sm">
                                <option value="">Select Category</option>
                                <option value="Healthcare">Healthcare</option>
                                <option value="Education">Education</option>
                                <option value="Fintech">Fintech</option>
                                <option value="Agriculture">Agriculture</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <button type="submit" class="w-full bg-purple-600 hover:bg-purple-500 text-white font-semibold py-3.5 rounded-xl transition-all shadow-lg shadow-purple-500/30">
                            Submit Idea
                        </button>
                    </form>
                </div>
            </div>

            <div id="submitEventSection" class="tab-content hidden max-w-3xl mx-auto">
                <div class="glass-card rounded-3xl p-8 md:p-10">
                    <h2 class="text-2xl font-bold text-white mb-2">Propose Event</h2>
                    <p class="text-gray-400 text-sm mb-8">Suggest workshops or seminars for the community.</p>
                    <div id="eventStatusMessage" class="hidden mb-4 p-3 rounded-lg text-sm bg-green-500/10 border border-green-500/20 text-green-400"></div>

                    <form id="eventForm" class="space-y-6">
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Event Title</label>
                            <input type="text" id="eventName" class="glass-input w-full rounded-xl py-3 px-4 text-sm">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Date</label>
                                <input type="date" id="eventDate" class="glass-input w-full rounded-xl py-3 px-4 text-sm">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Expected Time</label>
                                <input type="text" id="eventTime" class="glass-input w-full rounded-xl py-3 px-4 text-sm" placeholder="10:00 AM">
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1.5 uppercase">Description & Objectives</label>
                            <textarea id="eventDescription" rows="5" class="glass-input w-full rounded-xl py-3 px-4 text-sm"></textarea>
                        </div>
                        <button type="submit" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-semibold py-3.5 rounded-xl transition-all shadow-lg shadow-emerald-500/30">
                            Propose Event
                        </button>
                    </form>
                </div>
            </div>

        </main>
    </div>

    <div id="mobile-sidebar-overlay" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-30 hidden md:hidden" onclick="toggleMobileSidebar()"></div>
    
    <div id="mobile-sidebar" class="fixed top-0 left-0 h-full w-64 glass-sidebar z-40 transform -translate-x-full transition-transform duration-300 md:hidden flex flex-col">
        <div class="p-6 flex items-center justify-between border-b border-white/10">
            <span class="text-xl font-bold text-white">Menu</span>
            <button onclick="toggleMobileSidebar()" class="text-white"><i data-lucide="x"></i></button>
        </div>
        <nav class="flex-grow px-4 py-4 space-y-2 overflow-y-auto">
            <button onclick="showTab('dashboardOverview'); toggleMobileSidebar()" class="sidebar-link active w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 text-sm font-medium">Dashboard</button>
            <button onclick="showTab('profile'); toggleMobileSidebar()" class="sidebar-link w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 text-sm font-medium">My Profile</button>
            <a href="admin.html" class="sidebar-link w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 text-sm font-medium">Admin</a>
            <button onclick="showTab('submitProject'); toggleMobileSidebar()" class="sidebar-link w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 text-sm font-medium">Submit Project</button>
            <button id="logoutBtnMobile" class="w-full mt-4 bg-red-500/20 text-red-400 py-3 rounded-lg text-sm font-bold">Logout</button>
        </nav>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        lucide.createIcons();

        const firebaseConfig = {
            apiKey: "AIzaSyAIn9hB7Hx4Nwwk5Ar9bE3tFuo40VkBcc8",
            authDomain: "metsiedc-3010e.firebaseapp.com",
            databaseURL: "https://metsiedc-3010e-default-rtdb.firebaseio.com",
            projectId: "metsiedc-3010e",
            storageBucket: "metsiedc-3010e.firebasestorage.app",
            messagingSenderId: "954403413150",
            appId: "1:954403413150:web:2523a3377f15a3d6002f8f",
            measurementId: "G-6E7EK0D7JG"
        };

        let app, auth, db, currentUserId;

        try {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
        } catch (error) { console.error("Firebase Init Error", error); }

        // Auth State Listener
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                currentUserId = user.uid;
                document.getElementById('userEmailHeader').textContent = user.email;
                document.getElementById('userAvatarHeader').textContent = user.email.charAt(0).toUpperCase();
                document.getElementById('displayNameBanner').textContent = user.email.split('@')[0];
                if (db) fetchProfileData(currentUserId);
            } else {
                window.location.href = 'login.html';
            }
        });

        // Fetch Profile
        async function fetchProfileData(userId) {
            const docRef = doc(db, `users/${userId}/profile`, 'userProfile'); // Adjusted path for simplicity
            try {
                const docSnap = await getDoc(docRef);
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    // Update View
                    document.getElementById('displayNameOutput').textContent = data.name || 'Not set';
                    document.getElementById('bioOutput').textContent = data.bio || 'No bio available';
                    document.getElementById('emailOutput').textContent = auth.currentUser.email;
                    document.getElementById('contactNumberOutput').textContent = data.contact || 'Not set';
                    document.getElementById('locationOutput').textContent = data.city ? `${data.city}, ${data.state}` : 'Not set';
                    
                    // Update Form
                    document.getElementById('profileName').value = data.name || '';
                    document.getElementById('profileContact').value = data.contact || '';
                    document.getElementById('profileBio').value = data.bio || '';
                    document.getElementById('profileCity').value = data.city || '';
                    document.getElementById('profileState').value = data.state || '';
                    document.getElementById('profileLinkedIn').value = data.linkedin || '';
                    document.getElementById('profileInstagram').value = data.instagram || '';
                }
            } catch (e) { console.error("Profile fetch error", e); }
        }

        // Save Profile
        document.getElementById('profileForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            const originalText = btn.innerHTML;
            btn.innerHTML = 'Saving...';
            
            const data = {
                name: document.getElementById('profileName').value,
                contact: document.getElementById('profileContact').value,
                bio: document.getElementById('profileBio').value,
                city: document.getElementById('profileCity').value,
                state: document.getElementById('profileState').value,
                linkedin: document.getElementById('profileLinkedIn').value,
                instagram: document.getElementById('profileInstagram').value
            };

            try {
                await setDoc(doc(db, `users/${currentUserId}/profile`, 'userProfile'), data, { merge: true });
                fetchProfileData(currentUserId);
                showStatus('profileStatusMessage', 'Profile updated!', 'success');
            } catch (e) {
                showStatus('profileStatusMessage', 'Error updating profile.', 'error');
            } finally {
                btn.innerHTML = originalText;
            }
        });

        // Mock Submissions
        ['projectForm', 'ideaForm', 'eventForm'].forEach(formId => {
            document.getElementById(formId).addEventListener('submit', (e) => {
                e.preventDefault();
                const type = formId.replace('Form', '');
                showStatus(`${type}StatusMessage`, 'Submission simulated successfully (Demo).', 'success');
                e.target.reset();
            });
        });

        // Utils
        window.showTab = function(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(tabId + 'Section').classList.remove('hidden');
            
            document.querySelectorAll('.sidebar-link').forEach(el => el.classList.remove('active'));
            // Simple active state logic for demo
            event.currentTarget.classList.add('active');
        };

        function showStatus(elementId, msg, type) {
            const el = document.getElementById(elementId);
            el.textContent = msg;
            el.className = `mb-4 p-3 rounded-lg text-sm ${type === 'success' ? 'bg-green-500/10 border border-green-500/20 text-green-400' : 'bg-red-500/10 border border-red-500/20 text-red-400'}`;
            el.classList.remove('hidden');
            setTimeout(() => el.classList.add('hidden'), 3000);
        }

        // Mobile Menu
        window.toggleMobileSidebar = function() {
            const sidebar = document.getElementById('mobile-sidebar');
            const overlay = document.getElementById('mobile-sidebar-overlay');
            const isOpen = !sidebar.classList.contains('-translate-x-full');
            
            if(isOpen) {
                sidebar.classList.add('-translate-x-full');
                overlay.classList.add('hidden');
            } else {
                sidebar.classList.remove('-translate-x-full');
                overlay.classList.remove('hidden');
            }
        };

        document.getElementById('mobile-menu-toggle').addEventListener('click', toggleMobileSidebar);

        // Logout
        const logout = async () => {
            try { await signOut(auth); } catch(e) { alert(e.message); }
        };
        document.getElementById('logoutBtnSidebar').addEventListener('click', logout);
        document.getElementById('logoutBtnMobile').addEventListener('click', logout);

    </script>
</body>
</html>
